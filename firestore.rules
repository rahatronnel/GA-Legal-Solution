
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // -------------------------------------------------------------------------
    // Helper Functions
    // -------------------------------------------------------------------------
    function isAuthenticated() {
        return request.auth != null;
    }

    // -------------------------------------------------------------------------
    // Default Security Rule
    // By default, require authentication for any read or write access.
    // -------------------------------------------------------------------------
    match /{document=**} {
      allow read, write: if isAuthenticated();
    }

    // -------------------------------------------------------------------------
    // Singleton & Public Master Data
    // These collections contain general configuration or master list data.
    // The default rule above already protects them, but we can have more
    // granular rules here if needed in the future.
    // -------------------------------------------------------------------------
    match /settings/{docId} {
        allow write: if isAuthenticated();
    }
    match /vehicleTypes/{docId} {
        allow write: if isAuthenticated();
    }
    match /vehicleBrands/{docId} {
      allow write: if isAuthenticated();
    }
    match /locations/{docId} {
      allow write: if isAuthenticated();
    }
    match /routes/{docId} {
      allow write: if isAuthenticated();
    }
    match /tripPurposes/{docId} {
      allow write: if isAuthenticated();
    }
    match /expenseTypes/{docId} {
      allow write: if isAuthenticated();
    }
    match /maintenanceTypes/{docId} {
      allow write: if isAuthenticated();
    }
    match /maintenanceExpenseTypes/{docId} {
      allow write: if isAuthenticated();
    }
    match /parts/{docId} {
      allow write: if isAuthenticated();
    }
    match /serviceCenters/{docId} {
      allow write: if isAuthenticated();
    }
    match /accidentTypes/{docId} {
      allow write: if isAuthenticated();
    }
    match /severityLevels/{docId} {
      allow write: if isAuthenticated();
    }
    match /faultStatuses/{docId} {
      allow write: if isAuthenticated();
    }
    match /vendorCategories/{docId} {
      allow write: if isAuthenticated();
    }
    match /vendorNatureOfBusiness/{docId} {
      allow write: if isAuthenticated();
    }
    match /billTypes/{docId} {
      allow write: if isAuthenticated();
    }
    match /billCategories/{docId} {
      allow write: if isAuthenticated();
    }
    match /billItemCategories/{docId} {
        allow write: if isAuthenticated();
    }
    match /billItemMasters/{docId} {
      allow write: if isAuthenticated();
    }
    match /approvalRules/{docId} {
      allow write: if isAuthenticated();
    }

    // -------------------------------------------------------------------------
    // Protected User & Operational Data
    // The default rule protects these collections as well.
    // -------------------------------------------------------------------------
    match /sections/{docId} {
      allow write: if isAuthenticated();
    }
    match /designations/{docId} {
      allow write: if isAuthenticated();
    }
    match /employees/{docId} {
      allow write: if isAuthenticated();
    }
    match /vehicles/{docId} {
      allow write: if isAuthenticated();
    }
     match /drivers/{docId} {
      allow write: if isAuthenticated();
    }
     match /trips/{docId} {
      allow write: if isAuthenticated();
    }
    match /maintenanceRecords/{docId} {
      allow write: if isAuthenticated();
    }
     match /accidents/{docId} {
      allow write: if isAuthenticated();
    }
    match /vendors/{docId} {
      allow write: if isAuthenticated();
    }
    match /bills/{docId} {
      allow write: if isAuthenticated();
    }
  }
}
